#!/usr/bin/env python3

import sys

def add_path():
    from os.path import normpath, join, exists, dirname, abspath, realpath
    libdir = normpath(join(dirname(realpath(__file__)), ".."))
    if exists(join(libdir, "dowwner")):
        sys.path.insert(0, libdir)
    # sys.argv[0] = os.path.abspath(__file__)
    return

def main(argv):
    import argparse as ap

    import dowwner

    parser = ap.ArgumentParser("archsh")
    parser.add_argument("-r", "--root-dir", help="root directory",
                        default=None)
    parser.add_argument("-d", "--daemon", help="run as daemon",
                        action="store_true")
    parser.add_argument("-p", "--port", help="port number",
                        default=None)

    args = parser.parse_args(argv[1:])

    confs = dict()
    if args.root_dir:
        confs["rootdir"] = args.root_dir
    if args.port:
        confs["port"] = args.port

    # print(args)
    dowwner.main(**confs)
    return

if __name__ == "__main__":
    add_path()
    main(sys.argv)
